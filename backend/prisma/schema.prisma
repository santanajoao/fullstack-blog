generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Topic {
  id       String @id @default(uuid())
  name     String @unique
  imageUrl String @unique @map("image_url") @db.VarChar(300)

  posts      Post[]
  postTopics PostTopic[]

  @@map("topics")
}

model Account {
  id       String  @id @default(uuid())
  username String
  about    String?  @db.VarChar(200)
  email    String  @unique
  password String
  imageUrl String?

  image Image? @relation(fields: [imageId], references: [id])
  imageId String? @unique

  posts Post[]
  likes Likes[]

  @@map("accounts")
}

model Post {
  id          String   @id @default(uuid())
  imageUrl    String   @map("image_url") @db.VarChar(300)
  title       String   @db.VarChar(70)
  description String   @db.VarChar(200)
  content     String   @db.VarChar(4000)
  createdAt   DateTime @default(now()) @map("created_at")

  accountId String  @map("account_id")
  account   Account @relation(fields: [accountId], references: [id])

  topics     Topic[]
  postTopics PostTopic[]
  likes      Likes[]

  @@map("posts")
}

model PostTopic {
  topicId String @map("topic_id")
  topic   Topic  @relation(fields: [topicId], references: [id])

  postId String @map("post_id")
  post   Post   @relation(fields: [postId], references: [id])

  @@id([postId, topicId])
  @@map("post_topics")
}

model Likes {
  accountId String  @map("account_id")
  account   Account @relation(fields: [accountId], references: [id])

  postId String @map("post_id")
  post   Post   @relation(fields: [postId], references: [id])

  @@id([accountId, postId])
  @@map("likes")
}

model Image {
  id String @id @default(uuid())
  type String
  buffer Bytes @db.MediumBlob

  account Account?
}
